---
description: TypeScript coding standards
globs: "**/*.ts,**/*.tsx"
---

# TypeScript Standards

## Types

- **Avoid `any`** - Use `unknown` if type is truly unknown
- **Explicit return types** on public functions
- **Interfaces** for object shapes
- **Types** for unions and intersections

```typescript
// ‚úÖ Good
interface User {
  id: string;
  name: string;
}

type Status = "pending" | "active" | "completed";

function getUser(id: string): Promise<User> {
  // ...
}

// ‚ùå Avoid
function getUser(id: any): any { ... }
```

## Naming

| Element | Convention | Example |
|---------|------------|---------|
| Variables/Functions | camelCase | `getUserData()` |
| Types/Interfaces/Classes | PascalCase | `UserService` |
| Constants | UPPER_CASE | `MAX_RETRIES` |
| Generics | Single uppercase | `T`, `K`, `V` |

## Strict Mode

Always use strict TypeScript:

```json
// tsconfig.json
{
  "compilerOptions": {
    "strict": true,
    "noImplicitAny": true,
    "strictNullChecks": true
  }
}
```

## Async/Await

```typescript
// ‚úÖ Prefer async/await
async function fetchData(): Promise<Data> {
  const response = await fetch(url);
  return response.json();
}

// ‚ùå Avoid raw promises when possible
function fetchData(): Promise<Data> {
  return fetch(url).then(r => r.json());
}
```

## Error Handling

```typescript
// ‚úÖ Typed errors
class ValidationError extends Error {
  constructor(
    message: string,
    public readonly field: string
  ) {
    super(message);
    this.name = "ValidationError";
  }
}

// ‚úÖ Result pattern for expected failures
type Result<T, E = Error> = 
  | { success: true; data: T }
  | { success: false; error: E };
```

## Package Management

- **Runtime**: Node.js 22+
- **Package Manager**: pnpm
- **Lock file**: `pnpm-lock.yaml` (commit this)

```bash
# Install
pnpm install

# Add dependency
pnpm add axios

# Add dev dependency
pnpm add -D typescript

# Build
pnpm run build
```

## Documentation (JSDoc Gold Standard)

All public APIs (components, functions, interfaces) MUST follow the "Gold Standard" JSDoc pattern to ensure professional TypeDoc generation and IDE discoverability.

### Module/File Level
Every module must start with a `@packageDocumentation` block:
```typescript
/**
 * [A "selling" description focusing on the developer's goal]
 *
 * @packageDocumentation
 * @module [path/to/module]
 * @category [Rendering Pipeline | Player Experience | Game Systems | World Building | Entities & Simulation | UI & Interaction]
 *
 * ## Interactive Demos
 * - üéÆ [Live Demo](http://jonbogaty.com/nodejs-strata/demos/[demo].html)
 * - üì¶ [Example Source](https://github.com/jbcom/nodejs-strata/tree/main/examples/[example])
 *
 * ## API Documentation
 * - [Full API Reference](http://jonbogaty.com/nodejs-strata/api)
 * - [Examples Mapping](https://github.com/jbcom/nodejs-strata/blob/main/EXAMPLES_API_MAP.md#...)
 */
```

### Component/Function Level
Include a `@category` tag and at least one `@example`:
```typescript
/**
 * [Descriptive summary of the component/function]
 *
 * @category [Category Name]
 * @example
 * ```tsx
 * <MyComponent prop={value} />
 * ```
 */
```

### Interface/Prop Level
Every property must have a descriptive JSDoc comment:
```typescript
export interface MyProps {
  /** [Property description]. Default: [Value]. */
  size: number;
}
```

## Testing

```typescript
// Use vitest or jest
import { describe, it, expect } from "vitest";

describe("UserService", () => {
  it("should create user", async () => {
    const user = await service.create({ name: "Test" });
    expect(user.id).toBeDefined();
  });
});
```
